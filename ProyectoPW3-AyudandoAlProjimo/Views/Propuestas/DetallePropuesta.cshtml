@model Entidades.Partials.PropuestaWrapper

@{
    ViewBag.Title = "Propuesta";
}

@{
    <div class="row">
        <style>
            h2 {
                text-align: center;
                color: #4e73df;
            }

            h3 {
                color: #4e73df;
                font-size: 25px;
                font-weight: 800;
            }

            p {
                color: black;
            }

            .botones {
                width: 30%;
                margin: 5% 10% 2%;
                color: white !important;
            }

            .denuncia {
                width: 50%;
                margin: 8% 25% 2%;
            }

            .manito {
                cursor: no-drop !important;
            }
        </style>
        <h2 class="col-12">@Model.Propuesta.Nombre</h2>
        <div class="col-6" style="float: left;">
            <img class="card-img-top mt-3" style="width:100%;height:auto; margin:0 auto;" src="~/Content/img/@Model.Propuesta.Foto" alt="No se pudo cargar la foto">

            @if (Model.Propuesta.IdUsuarioCreador != Model.idLogeado)
            {
                if (@Model.voto == 1)
                {
                    <h5 style="margin-top: 5%;">Ya votaste que te gustó esta propuesta</h5>
                    <button class="btn btn-secondary float-left botones manito">Me gusta <i class="fas fa-angle-double-right"></i></button>
                    <a href="~/Propuestas/ValoracionPropuesta?IdUser=@Session["usuario"]&IdPropuesta=@Model.Propuesta.IdPropuesta&valoracion=2" class="btn btn-danger float-left botones">No me gusta <i class="fas fa-angle-double-right"></i></a>
                }
                else if (@Model.voto == 2)
                {
                    <h5 style="margin-top: 5%;">Ya votaste que no te gustó esta propuesta</h5>
                    <a href="~/Propuestas/ValoracionPropuesta?IdUser=@Session["usuario"]&IdPropuesta=@Model.Propuesta.IdPropuesta&valoracion=1" class="btn btn-success float-left botones">Me gusta <i class="fas fa-angle-double-right"></i></a>
                    <a class="btn btn-secondary float-left botones manito">No me gusta <i class="fas fa-angle-double-right"></i></a>
                }
                else if (@Model.voto == 3)
                {
                    <h5 style="margin-top: 5%;">Votá esta propuesta</h5>
                    <a href="~/Propuestas/ValoracionPropuesta?IdUser=@Session["usuario"]&IdPropuesta=@Model.Propuesta.IdPropuesta&valoracion=1" class="btn btn-success float-left botones">Me gusta <i class="fas fa-angle-double-right"></i></a>
                    <a href="~/Propuestas/ValoracionPropuesta?IdUser=@Session["usuario"]&IdPropuesta=@Model.Propuesta.IdPropuesta&valoracion=2" class="btn btn-danger float-left botones">No me gusta <i class="fas fa-angle-double-right"></i></a>
                }
            }

            <h3>
                Valoración:
            </h3>
            <div class="progress">
                <div class="progress-bar bg-success" style="width: @Model.porcentajePositivo%;">
                    @Model.porcentajePositivo%
                </div>
                <div class="progress-bar bg-danger" style="width:@Model.porcentajeNegativo%;">
                    @Model.porcentajeNegativo%
                </div>
            </div>
            @if (Model.Propuesta.IdUsuarioCreador != Model.idLogeado)
            {
                if (@Model.Denuncia >= 1)
                {
                    <br />
                    <h5>Usted ya denunció esta propuesta</h5>
                }
                else
                {
                    <a href="/Denuncias/IrADenunciar?IdPropuesta=@Model.Propuesta.IdPropuesta&IdUsuario=@Session["usuario"]" class="btn btn-warning float-left denuncia">Denunciar <i class="fas fa-angle-double-right"></i></a>
                }
            }
        </div>
        <div class="col-6" style="float: left;">
            <h3>Descripción: </h3>
            <p>@Model.Propuesta.Descripcion</p>
            <h3>Usuario:</h3>
            <p>@Model.Usuario.UserName</p>
            <h3>Fecha de creación:</h3>
            <p>@Model.Propuesta.FechaCreacion.ToString("dd/MM/yyyy")</p>
            <h3>Fecha de finalización:</h3>
            <p>@Model.Propuesta.FechaFin.ToString("dd/MM/yyyy")</p>
            <h3>Contacto:</h3>
            <p>@Model.Propuesta.TelefonoContacto</p>
            @if (Model.Propuesta.TipoDonacion == 3)
            {<div style="text-align:center; background-color: rgba(60,191,255,0.5); padding: 5%;">
                    <h3>Donaciones de horas de trabajo requeridas:</h3>
                    <br />
                    <h4 style="color: red;">Se necesita: @Model.PropuestasDonacionesHorasTrabajo hs</h4>
                    <h4 style="color: green;">Se donaron:@Model.GetDonacionesHorasTrabajo hs</h4>

                    @if (@Model.PropuestasDonacionesHorasTrabajo > @Model.GetDonacionesHorasTrabajo)
                    {
                        <h4 style="color: red;">Faltan: @Model.DonacionesHorasFaltantes hs</h4>
                        if (Model.Propuesta.IdUsuarioCreador != Model.idLogeado)
                        {
                            <a href="~/Donaciones/RealizarDonacion/@Model.Propuesta.IdPropuesta" class="btn btn-warning float-left denuncia">Donar <i class="fas fa-angle-double-right"></i></a>
                        }
                    }
                    else
                    {
                        <h4 style="color: green;">¡Se completaron las donaciones necesarias!</h4>
                    }
                </div>
            }
            @if (Model.Propuesta.TipoDonacion == 2)
            {
                <h3>Donaciones de insumos requeridas:</h3>

                <table class="table" style="width: 50%; float: left; text-align: center;">

                    <thead>
                        <tr>
                            <th>Insumo</th>
                            <th>Requerida</th>
                        </tr>
                    </thead>

                    <tbody>

                        @foreach (var insumos in Model.PropuestasDonacionesInsumos)
                        {
                            <tr>
                                <td>@insumos.Nombre</td>

                                <td>@insumos.Cantidad</td>
                            </tr>
                        }
                    </tbody>
                </table>

                <table class="table" style="width: 25%; float: left; text-align: center;">

                    <thead>
                        <tr>

                            <th>Donada</th>
                        </tr>
                    </thead>

                    <tbody>

                        @foreach (var insumos2 in Model.GetDonacionesInsumos)
                        {
                            <tr>
                                <td>@insumos2</td>
                            </tr>
                        }
                    </tbody>
                </table>

                <table class="table" style="width: 25%; float: left; text-align: center;">

                    <thead>
                        <tr>

                            <th>Faltantes: </th>
                        </tr>
                    </thead>

                    <tbody>

                        @foreach (var totales in Model.TotalesDonacionesInsumos)
                        {
                            <tr>
                                <td>@totales</td>
                            </tr>
                        }
                    </tbody>
                </table>

                if (Model.Propuesta.IdUsuarioCreador != Model.idLogeado)
                {
                    <a href="~/Donaciones/RealizarDonacion/@Model.Propuesta.IdPropuesta" class="btn btn-warning float-left denuncia">Donar <i class="fas fa-angle-double-right"></i></a>
                }
            }

            @if (Model.Propuesta.TipoDonacion == 1)
            {
                <div style="text-align:center; padding: 5%;">
                    <h3>Donaciones monetarias requeridas:</h3>

                    <table class="table" style="width: 100%; float: left; text-align: center;">

                        <tr>
                            <th class="table-danger">Se necesitan: </th>
                            <th class="table-danger">$@Model.PropuestasDonacionesMonetarias</th>
                        </tr>

                        <tr>
                            <th class="table-success">Se donaron: </th>
                            <th class="table-success">$@Model.GetDonacionesMonetarias</th>
                        </tr>

                        <tr>
                            <th class="table-info">Faltan: </th>
                            <th class="table-info">
                                @if (@Model.PropuestasDonacionesMonetarias > @Model.GetDonacionesMonetarias)
                                {
                                    <h4 style="color: red;">$@Model.DonacionesMonetariasFaltantes</h4>
                                }
                                else
                                {
                                    <h4 style="color: green;">¡Se completaron las donaciones necesarias!</h4>
                                }
                            </th>

                        </tr>
                    </table>
                    @if (@Model.PropuestasDonacionesMonetarias > @Model.GetDonacionesMonetarias)
                    {
                        if (Model.Propuesta.IdUsuarioCreador != Model.idLogeado)
                        {
                        <a href="~/Donaciones/RealizarDonacion/@Model.Propuesta.IdPropuesta" class="btn btn-warning float-left denuncia">Donar <i class="fas fa-angle-double-right"></i></a>
                        }
                    }
                </div>
            }
        </div>

    </div>
}